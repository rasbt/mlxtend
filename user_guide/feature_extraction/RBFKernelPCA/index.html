<!DOCTYPE html>
<html lang="en">

<head>
    <page.page.meta charset="utf-8">
    <page.page.meta http-equiv="X-UA-Compatible" page.content="IE=edge">
    <page.page.meta name="viewport" page.content="width=device-width, initial-scale=1.0">
    <page.page.meta name="description" page.content="A library consisting of useful tools and extensions for the day-to-day data science tasks."> 
    <page.page.meta name="author" page.content="Sebastian Raschka"> 
    <link rel="canonical" href="http://rasbt.github.io/mlxtend/user_guide/feature_extraction/RBFKernelPCA/"> 
    <link rel="shortcut icon" href="../../../img/favicon.ico">

    <title>RBFKernelPCA - mlxtend</title>

    <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/cinder.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">

    <!--
    <link href="../../../extra.css" rel="stylesheet">-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
    <script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-38457794-2', 'rasbt.github.io/mlxtend/');
    ga('send', 'pageview');
    </script>
    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">mlxtend</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../USER_GUIDE_INDEX/">USER GUIDE INDEX</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">frequent_patterns</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../frequent_patterns/apriori/">Apriori</a>
</li>

        
            
<li >
    <a href="../../frequent_patterns/association_rules/">Association rules</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">classifier</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../classifier/EnsembleVoteClassifier/">EnsembleVoteClassifier</a>
</li>

        
            
<li >
    <a href="../../classifier/StackingClassifier/">StackingClassifier</a>
</li>

        
            
<li >
    <a href="../../classifier/StackingCVClassifier/">StackingCVClassifier</a>
</li>

        
            
<li >
    <a href="../../classifier/Perceptron/">Perceptron</a>
</li>

        
            
<li >
    <a href="../../classifier/Adaline/">Adaline</a>
</li>

        
            
<li >
    <a href="../../classifier/LogisticRegression/">LogisticRegression</a>
</li>

        
            
<li >
    <a href="../../classifier/SoftmaxRegression/">SoftmaxRegression</a>
</li>

        
            
<li >
    <a href="../../classifier/MultiLayerPerceptron/">MultiLayerPerceptron</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">regressor</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../regressor/LinearRegression/">LinearRegression</a>
</li>

        
            
<li >
    <a href="../../regressor/StackingRegressor/">StackingRegressor</a>
</li>

        
            
<li >
    <a href="../../regressor/StackingCVRegressor/">StackingCVRegressor</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">feature_selection</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../feature_selection/SequentialFeatureSelector/">SequentialFeatureSelector</a>
</li>

        
            
<li >
    <a href="../../feature_selection/ExhaustiveFeatureSelector/">ExhaustiveFeatureSelector</a>
</li>

        
            
<li >
    <a href="../../feature_selection/ColumnSelector/">ColumnSelector</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">feature_extraction</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../PrincipalComponentAnalysis/">PrincipalComponentAnalysis</a>
</li>

        
            
<li >
    <a href="../LinearDiscriminantAnalysis/">LinearDiscriminantAnalysis</a>
</li>

        
            
<li class="active">
    <a href="./">RBFKernelPCA</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">cluster</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../cluster/Kmeans/">Kmeans</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">evaluate</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../evaluate/confusion_matrix/">Confusion matrix</a>
</li>

        
            
<li >
    <a href="../../evaluate/mcnemar_table/">Mcnemar table</a>
</li>

        
            
<li >
    <a href="../../evaluate/mcnemar/">Mcnemar</a>
</li>

        
            
<li >
    <a href="../../evaluate/lift_score/">Lift score</a>
</li>

        
            
<li >
    <a href="../../evaluate/scoring/">Scoring</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">preprocessing</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../preprocessing/MeanCenterer/">MeanCenterer</a>
</li>

        
            
<li >
    <a href="../../preprocessing/minmax_scaling/">Minmax scaling</a>
</li>

        
            
<li >
    <a href="../../preprocessing/shuffle_arrays_unison/">Shuffle arrays unison</a>
</li>

        
            
<li >
    <a href="../../preprocessing/standardize/">Standardize</a>
</li>

        
            
<li >
    <a href="../../preprocessing/one-hot_encoding/">One hot encoding</a>
</li>

        
            
<li >
    <a href="../../preprocessing/OnehotTransactions/">OnehotTransactions</a>
</li>

        
            
<li >
    <a href="../../preprocessing/DenseTransformer/">DenseTransformer</a>
</li>

        
            
<li >
    <a href="../../preprocessing/CopyTransformer/">CopyTransformer</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">data</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../data/autompg_data/">Autompg data</a>
</li>

        
            
<li >
    <a href="../../data/boston_housing_data/">Boston housing data</a>
</li>

        
            
<li >
    <a href="../../data/iris_data/">Iris data</a>
</li>

        
            
<li >
    <a href="../../data/mnist_data/">Mnist data</a>
</li>

        
            
<li >
    <a href="../../data/loadlocal_mnist/">Loadlocal mnist</a>
</li>

        
            
<li >
    <a href="../../data/wine_data/">Wine data</a>
</li>

        
            
<li >
    <a href="../../data/three_blobs_data/">Three blobs data</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">file_io</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../file_io/find_filegroups/">Find filegroups</a>
</li>

        
            
<li >
    <a href="../../file_io/find_files/">Find files</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">plotting</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../plotting/plot_decision_regions/">Plot decision regions</a>
</li>

        
            
<li >
    <a href="../../plotting/plot_learning_curves/">Plot learning curves</a>
</li>

        
            
<li >
    <a href="../../plotting/plot_sequential_feature_selection/">Plot sequential feature selection</a>
</li>

        
            
<li >
    <a href="../../plotting/plot_confusion_matrix/">Plot confusion matrix</a>
</li>

        
            
<li >
    <a href="../../plotting/plot_linear_regression/">Plot linear regression</a>
</li>

        
            
<li >
    <a href="../../plotting/category_scatter/">Category scatter</a>
</li>

        
            
<li >
    <a href="../../plotting/enrichment_plot/">Enrichment plot</a>
</li>

        
            
<li >
    <a href="../../plotting/stacked_barplot/">Stacked barplot</a>
</li>

        
            
<li >
    <a href="../../plotting/checkerboard_plot/">Checkerboard plot</a>
</li>

        
            
<li >
    <a href="../../plotting/ecdf/">Ecdf</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">math</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../math/num_combinations/">Num combinations</a>
</li>

        
            
<li >
    <a href="../../math/num_permutations/">Num permutations</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">text</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../text/generalize_names/">Generalize names</a>
</li>

        
            
<li >
    <a href="../../text/generalize_names_duplcheck/">Generalize names duplcheck</a>
</li>

        
            
<li >
    <a href="../../text/tokenizer/">Tokenizer</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">utils</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../utils/Counter/">Counter</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">general concepts</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../general_concepts/activation-functions/">Activation functions</a>
</li>

        
            
<li >
    <a href="../../general_concepts/gradient-optimization/">Gradient optimization</a>
</li>

        
            
<li >
    <a href="../../general_concepts/linear-gradient-derivative/">Linear gradient derivative</a>
</li>

        
            
<li >
    <a href="../../general_concepts/regularization-linear/">Regularization linear</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.frequent_patterns/">Mlxtend.frequent patterns</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.classifier/">Mlxtend.classifier</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.data/">Mlxtend.data</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.evaluate/">Mlxtend.evaluate</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.feature_selection/">Mlxtend.feature selection</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.feature_extraction/">Mlxtend.feature extraction</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.cluster/">Mlxtend.cluster</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.file_io/">Mlxtend.file io</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.plotting/">Mlxtend.plotting</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.preprocessing/">Mlxtend.preprocessing</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.regressor/">Mlxtend.regressor</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.text/">Mlxtend.text</a>
</li>

                        
                            
<li >
    <a href="../../../api_subpackages/mlxtend.utils/">Mlxtend.utils</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../../../installation/">Installation</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../changelog/">Release Notes</a>
</li>

                        
                            
<li >
    <a href="../../../contributing/">How To Contribute</a>
</li>

                        
                            
<li >
    <a href="../../../contributors/">Contributors</a>
</li>

                        
                            
<li >
    <a href="../../../license/">License</a>
</li>

                        
                            
<li >
    <a href="../../../cite/">Citing Mlxtend</a>
</li>

                        
                            
<li >
    <a href="../../../discuss/">Discuss</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../LinearDiscriminantAnalysis/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../cluster/Kmeans/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                


                    <li>
                        <a href="https://github.com/rasbt/mlxtend">
                                <i class="fa fa-github"></i>
                            GitHub
                        </a>
                    </li>



                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#rbf-kernel-principal-component-analysis">RBF Kernel Principal Component Analysis</a></li>
        
    
        <li class="main "><a href="#overview">Overview</a></li>
        
            <li><a href="#principal-component-analysis">Principal Component Analysis</a></li>
                <!--  -->
        
            <li><a href="#nonlinear-dimensionality-reduction">Nonlinear dimensionality reduction</a></li>
                <!--  -->
        
            <li><a href="#kernel-functions-and-the-kernel-trick">Kernel functions and the kernel trick</a></li>
                <!--  -->
        
            <li><a href="#gaussian-radial-basis-function-rbf-kernel-pca">Gaussian radial basis function (RBF) Kernel PCA</a></li>
                <!--  -->
        
            <li><a href="#rbf-kernel-pca-step-by-step">RBF kernel PCA step-by-step</a></li>
                <!-- 
                    <li><a href="#1-computation-of-the-kernel-similarity-matrix">1. Computation of the kernel (similarity) matrix.</a></li>
            
                    <li><a href="#2-eigendecomposition-of-the-kernel-matrix">2. Eigendecomposition of the kernel matrix.</a></li>
             -->
        
            <li><a href="#projecting-new-data">Projecting new data</a></li>
                <!--  -->
        
            <li><a href="#references">References</a></li>
                <!--  -->
        
    
        <li class="main "><a href="#example-1-half-moon-shapes">Example 1 - Half-moon shapes</a></li>
        
            <li><a href="#projecting-new-data_1">Projecting new data</a></li>
                <!--  -->
        
    
        <li class="main "><a href="#example-2-concentric-circles">Example 2 - Concentric circles</a></li>
        
    
        <li class="main "><a href="#api">API</a></li>
        
            <li><a href="#methods">Methods</a></li>
                <!--  -->
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h2 id="rbf-kernel-principal-component-analysis">RBF Kernel Principal Component Analysis</h2>
<p>Implementation of RBF Kernel Principal Component Analysis for non-linear dimensionality reduction</p>
<blockquote>
<p>from mlxtend.feature_extraction import RBFKernelPCA</p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>Most machine learning algorithms have been developed and statistically validated for linearly separable data. Popular examples are linear classifiers like Support Vector Machines (SVMs) or the (standard) Principal Component Analysis (PCA) for dimensionality reduction. However, most real world data requires nonlinear methods in order to perform tasks that involve the analysis and discovery of patterns successfully.</p>
<p>The focus of this overview is to briefly introduce the idea of kernel methods and to implement a Gaussian radius basis function (RBF) kernel that is used to perform nonlinear dimensionality reduction via BF kernel principal component analysis (kPCA).</p>
<h3 id="principal-component-analysis">Principal Component Analysis</h3>
<p>The main purpose of principal component analysis (PCA) is the analysis of data to identify patterns that represent the data “well.” The principal components can be understood as new axes of the dataset that maximize the variance along those axes (the eigenvectors of the covariance matrix). In other words, PCA aims to find the axes with maximum variances along which the data is most spread.</p>
<p><img alt="" src="../RBFKernelPCA_files/pca_1.png" /></p>
<p>For more details, please see the related article on <a href="../PrincipalComponentAnalysis/"><code>mlxtend.feature_extraction.PrincipalComponentAnalysis</code></a>.</p>
<h3 id="nonlinear-dimensionality-reduction">Nonlinear dimensionality reduction</h3>
<p>The “classic” PCA approach described above is a linear projection technique that works well if the data is linearly separable. However, in the case of linearly inseparable data, a nonlinear technique is required if the task is to reduce the dimensionality of a dataset.</p>
<p><img alt="" src="../RBFKernelPCA_files/linear_vs_nonlinear.png" /></p>
<h3 id="kernel-functions-and-the-kernel-trick">Kernel functions and the kernel trick</h3>
<p>The basic idea to deal with linearly inseparable data is to project it onto a higher dimensional space where it becomes linearly separable. Let us call this nonlinear mapping function <script type="math/tex">\phi</script> so that the mapping of a sample <script type="math/tex">\mathbf{x}</script> can be written as <script type="math/tex">\mathbf{x} \rightarrow \phi (\mathbf{x})</script>, which is called "kernel function."</p>
<p>Now, the term "kernel" describes a function that calculates the dot product of the images of the samples <script type="math/tex">\mathbf{x}</script> under <script type="math/tex">\phi</script>.</p>
<p>
<script type="math/tex; mode=display">\kappa(\mathbf{x_i, x_j}) =  \phi (\mathbf{x_i}) \phi (\mathbf{x_j})^T</script>
</p>
<p>More details about the derivation of this equation are provided in this excellent review article by Quan Wang: <a href="http://arxiv.org/abs/1207.3538">Kernel Principal Component Analysis and its Applications in Face Recognition and Active Shape Models</a>.[<a href="#References">1</a>]</p>
<p>In other words, the function <script type="math/tex">\phi</script> maps the original d-dimensional features into a larger, k-dimensional feature space by creating nononlinear combinations of the original features. For example, if <script type="math/tex">\mathbf{x}</script> consists of 2 features:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{x} = \big[x_1 \quad x_2\big]^T \quad \quad \mathbf{x} \in I\!R^d
</script>
</p>
<p>
<script type="math/tex; mode=display">
\Downarrow \phi
</script>
</p>
<p>
<script type="math/tex; mode=display">
\mathbf{x}' = \big[x_1 \quad x_2 \quad x_1 x_2 \quad x_{1}^2 \quad x_1 x_{2}^3 \quad \dots \big]^T \quad \quad \mathbf{x} \in I\!R^k (k >> d)
</script>
</p>
<p>Often, the mathematical definition of the RBF kernel is written and implemented as</p>
<p>
<script type="math/tex; mode=display">
\kappa(\mathbf{x_i, x_j}) = exp\bigg(- \gamma \; \lVert\mathbf{x_i - x_j }\rVert^{2}_{2} \bigg)
</script>
</p>
<p>where <script type="math/tex">\textstyle\gamma = \tfrac{1}{2\sigma^2}</script> is a free parameter that is to be optimized.</p>
<h3 id="gaussian-radial-basis-function-rbf-kernel-pca">Gaussian radial basis function (RBF) Kernel PCA</h3>
<p>In the linear PCA approach, we are interested in the principal components that maximize the variance in the dataset. This is done by extracting the eigenvectors (principle components) that correspond to the largest eigenvalues based on the covariance matrix:</p>
<p>
<script type="math/tex; mode=display">\text{Cov} = \frac{1}{N} \sum_{i=1}^{N} \mathbf{x_i} \mathbf{x_i}^T</script>
</p>
<p>Bernhard Scholkopf (<a href="http://dl.acm.org/citation.cfm?id=299113">Kernel Principal Component Analysis</a> [<a href="#References">2</a>]) generalized this approach for data that was mapped onto the higher dimensional space via a kernel function:</p>
<p>
<script type="math/tex; mode=display">\text{Cov} = \frac{1}{N} \sum_{i=1}^{N} \phi(\mathbf{x_i}) \phi(\mathbf{x_i})^T</script>
</p>
<p>However, in practice the the covariance matrix in the higher dimensional space is not calculated explicitly (kernel trick). Therefore, the implementation of RBF kernel PCA does not yield the principal component axes (in contrast to the standard PCA), but the obtained eigenvectors can be understood as projections of the data onto the principal components.</p>
<h3 id="rbf-kernel-pca-step-by-step">RBF kernel PCA step-by-step</h3>
<h4 id="1-computation-of-the-kernel-similarity-matrix">1. Computation of the kernel (similarity) matrix.</h4>
<p>In this first step, we need to calculate</p>
<p>
<script type="math/tex; mode=display">\kappa(\mathbf{x_i, x_j}) = exp\bigg(- \gamma \; \lVert\mathbf{x_i - x_j }\rVert^{2}_{2} \bigg)</script>
</p>
<p>for every pair of points. E.g., if we have a dataset of 100 samples, this step would result in a symmetric 100x100 kernel matrix.</p>
<h4 id="2-eigendecomposition-of-the-kernel-matrix">2. Eigendecomposition of the kernel matrix.</h4>
<p>Since it is not guaranteed that the kernel matrix is centered, we can apply the following equation to do so:</p>
<p>
<script type="math/tex; mode=display">K' = K - \mathbf{1_N} K - K \mathbf{1_N} + \mathbf{1_N} K \mathbf{1_N}</script>
</p>
<p>where <script type="math/tex">\mathbf{1_N}</script> is (like the kernel matrix) a <script type="math/tex">N\times N</script> matrix with all values equal to <script type="math/tex">\frac{1}{N}</script>. [<a href="#References">3</a>]</p>
<p>Now, we have to obtain the eigenvectors of the centered kernel matrix that correspond to the largest eigenvalues. Those eigenvectors are the data points already projected onto the respective principal components.</p>
<h3 id="projecting-new-data">Projecting new data</h3>
<p>So far, so good, in the sections above, we have been projecting an dataset onto a new feature subspace. However, in a real application, we are usually interested in mapping new data points onto the same new feature subspace (e.g., if are working with a training and a test dataset in pattern classification tasks).</p>
<p>Remember, when we computed the eigenvectors <script type="math/tex">\mathbf{\alpha}</script> of the centered kernel matrix, those values were actually already the projected datapoints onto the principal component axis <script type="math/tex">\mathbf{g}</script>.</p>
<p>If we want to project a new data point <script type="math/tex">\mathbf{x}</script> onto this principal component axis, we'd need to compute <script type="math/tex">\phi(\mathbf{x})^T  \mathbf{g}</script>.</p>
<p>Fortunately, also here, we don't have to compute <script type="math/tex">\phi(\mathbf{x})^T  \mathbf{g}</script> explicitely but use the kernel trick to calculate the RBF kernel between the new data point and every data point <script type="math/tex">j</script> in the training dataset:</p>
<p>
<script type="math/tex; mode=display">\phi(\mathbf{x})^T  \mathbf{g}  = \sum_j \alpha_{i} \; \phi(\mathbf{x}) \; \phi(\mathbf{x_j})^T</script>
</p>
<p>
<script type="math/tex; mode=display">=  \sum_j \alpha_{i} \; \kappa(\mathbf{x}, \mathbf{x_j})</script>
</p>
<p>and the eigenvectors <script type="math/tex">\alpha</script> and eigenvalues <script type="math/tex">\lambda</script> of the Kernel matrix <script type="math/tex">\mathbf{K}</script> satisfy the equation
<script type="math/tex">\mathbf{K} \alpha = \lambda \alpha</script>, we just need to normalize the eigenvector by the corresponding eigenvalue.</p>
<h3 id="references">References</h3>
<p>[1] Q. Wang. <a href="http://arxiv.org/abs/1207.3538">Kernel principal component analysis and its applications in face recognition and active shape models</a>. CoRR, abs/1207.3538, 2012.</p>
<p>[2] B. Scholkopf, A. Smola, and K.-R. Muller. <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.128.7613">Kernel principal component analysis</a>. pages 583–588, 1997.</p>
<p>[3] B. Scholkopf, A. Smola, and K.-R. Muller. <a href="http://www.mitpressjournals.org/doi/abs/10.1162/089976698300017467#.VBh9QkuCFHg">Nonlinear component analysis as a kernel eigenvalue problem</a>. Neural computation, 10(5):1299–1319, 1998.</p>
<h2 id="example-1-half-moon-shapes">Example 1 - Half-moon shapes</h2>
<p>We will start with a simple example of 2 half-moon shapes generated by the <code>make_moons</code> function from scikit-learn.</p>
<pre><code class="python">import matplotlib.pyplot as plt
from sklearn.datasets import make_moons

X, y = make_moons(n_samples=50, random_state=1)

plt.scatter(X[y==0, 0], X[y==0, 1], 
            color='red', marker='o', alpha=0.5)
plt.scatter(X[y==1, 0], X[y==1, 1], 
            color='blue', marker='^', alpha=0.5)
plt.ylabel('y coordinate')
plt.xlabel('x coordinate')

plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_15_0.png" /></p>
<p>Since the two half-moon shapes are linearly inseparable, we expect that the “classic” PCA will fail to give us a “good” representation of the data in 1D space. Let us use <code>PCA</code> class to perform the dimensionality reduction.</p>
<pre><code class="python">from mlxtend.feature_extraction import PrincipalComponentAnalysis as PCA

pca = PCA(n_components=2)
X_pca = pca.fit(X).transform(X)

plt.scatter(X_pca[y==0, 0], X_pca[y==0, 1], 
            color='red', marker='o', alpha=0.5)
plt.scatter(X_pca[y==1, 0], X_pca[y==1, 1], 
            color='blue', marker='^', alpha=0.5)

plt.xlabel('PC1')
plt.ylabel('PC2')
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_17_0.png" /></p>
<p>As we can see, the resulting principal components do not yield a subspace where the data is linearly separated well. Note that PCA is a unsupervised method and does not “consider” class labels in order to maximize the variance in contrast to Linear Discriminant Analysis. Here, the colors blue and red are just added for visualization purposes to indicate the degree of separation.</p>
<p>Next, we will perform dimensionality reduction via RBF kernel PCA on our half-moon data. The choice of <script type="math/tex">\gamma</script>
depends on the dataset and can be obtained via hyperparameter tuning techniques like Grid Search. Hyperparameter tuning is a broad topic itself, and here I will just use a <script type="math/tex">\gamma</script>-value that I found to produce “good” results.</p>
<pre><code class="python">from mlxtend.data import iris_data
from mlxtend.preprocessing import standardize
from mlxtend.feature_extraction import RBFKernelPCA as KPCA

kpca = KPCA(gamma=15.0, n_components=2)
kpca.fit(X)
X_kpca = kpca.X_projected_
</code></pre>

<p>Please note that the components of kernel methods such as RBF kernel PCA already represent the projected data points (in contrast to PCA, where the component axis are the "top k" eigenvectors thar are used to contruct a projection matrix, which is then used to transform the training samples). Thus, the projected training set is available after fitting via the <code>.X_projected_</code> attribute.</p>
<pre><code class="python">plt.scatter(X_kpca[y==0, 0], X_kpca[y==0, 1], 
            color='red', marker='o', alpha=0.5)
plt.scatter(X_kpca[y==1, 0], X_kpca[y==1, 1], 
            color='blue', marker='^', alpha=0.5)

plt.title('First 2 principal components after RBF Kernel PCA')
plt.xlabel('PC1')
plt.ylabel('PC2')
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_22_0.png" /></p>
<p>The new feature space is linearly separable now. Since we are often interested in dimensionality reduction, let's have a look at the first component only.</p>
<pre><code class="python">import numpy as np

plt.scatter(X_kpca[y==0, 0], np.zeros((25, 1)), 
            color='red', marker='o', alpha=0.5)
plt.scatter(X_kpca[y==1, 0], np.zeros((25, 1)), 
            color='blue', marker='^', alpha=0.5)

plt.title('First principal component after RBF Kernel PCA')
plt.xlabel('PC1')
plt.yticks([])
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_24_0.png" /></p>
<p>We can clearly see that the projection via RBF kernel PCA yielded a subspace where the classes are separated well. Such a subspace can then be used as input for generalized linear classification models, e.g.,  logistic regression.</p>
<h4 id="projecting-new-data_1">Projecting new data</h4>
<p>Finally, via the transform method, we can project new data onto the new component axes.</p>
<pre><code class="python">import matplotlib.pyplot as plt
from sklearn.datasets import make_moons

X2, y2 = make_moons(n_samples=200, random_state=5)
X2_kpca = kpca.transform(X2)

plt.scatter(X_kpca[y==0, 0], X_kpca[y==0, 1], 
            color='red', marker='o', alpha=0.5, label='fit data')
plt.scatter(X_kpca[y==1, 0], X_kpca[y==1, 1], 
            color='blue', marker='^', alpha=0.5, label='fit data')

plt.scatter(X2_kpca[y2==0, 0], X2_kpca[y2==0, 1], 
            color='orange', marker='v', 
            alpha=0.2, label='new data')
plt.scatter(X2_kpca[y2==1, 0], X2_kpca[y2==1, 1], 
            color='cyan', marker='s', 
            alpha=0.2, label='new data')

plt.legend()
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_28_0.png" /></p>
<h2 id="example-2-concentric-circles">Example 2 - Concentric circles</h2>
<p>Following the concepts explained in example 1, let's have a look at another classic case: 2 concentric circles with random noise produced by scikit-learn’s <code>make_circles</code>.</p>
<pre><code class="python">from sklearn.datasets import make_circles

X, y = make_circles(n_samples=1000, random_state=123, 
                    noise=0.1, factor=0.2)

plt.figure(figsize=(8,6))

plt.scatter(X[y==0, 0], X[y==0, 1], color='red', alpha=0.5)
plt.scatter(X[y==1, 0], X[y==1, 1], color='blue', alpha=0.5)
plt.title('Concentric circles')
plt.ylabel('y coordinate')
plt.xlabel('x coordinate')
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_31_0.png" /></p>
<pre><code class="python">from mlxtend.data import iris_data
from mlxtend.preprocessing import standardize
from mlxtend.feature_extraction import RBFKernelPCA as KPCA

kpca = KPCA(gamma=15.0, n_components=2)
kpca.fit(X)
X_kpca = kpca.X_projected_
</code></pre>

<pre><code class="python">plt.scatter(X_kpca[y==0, 0], X_kpca[y==0, 1], 
            color='red', marker='o', alpha=0.5)
plt.scatter(X_kpca[y==1, 0], X_kpca[y==1, 1], 
            color='blue', marker='^', alpha=0.5)

plt.title('First 2 principal components after RBF Kernel PCA')
plt.xlabel('PC1')
plt.ylabel('PC2')
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_33_0.png" /></p>
<pre><code class="python">plt.scatter(X_kpca[y==0, 0], np.zeros((500, 1)), 
            color='red', marker='o', alpha=0.5)
plt.scatter(X_kpca[y==1, 0], np.zeros((500, 1)), 
            color='blue', marker='^', alpha=0.5)

plt.title('First principal component after RBF Kernel PCA')
plt.xlabel('PC1')
plt.yticks([])
plt.show()
</code></pre>

<p><img alt="png" src="../RBFKernelPCA_files/RBFKernelPCA_34_0.png" /></p>
<h2 id="api">API</h2>
<p><em>RBFKernelPCA(gamma=15.0, n_components=None, copy_X=True)</em></p>
<p>RBF Kernel Principal Component Analysis for dimensionality reduction.</p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><code>gamma</code> : float (default: 15.0)</p>
<p>Free parameter (coefficient) of the RBF kernel.</p>
</li>
<li>
<p><code>n_components</code> : int (default: None)</p>
<p>The number of principal components for transformation.
Keeps the original dimensions of the dataset if <code>None</code>.</p>
</li>
<li>
<p><code>copy_X</code> : bool (default: True)</p>
<p>Copies training data, which is required to compute the projection
of new data via the transform method. Uses a reference to X if False.</p>
</li>
</ul>
<p><strong>Attributes</strong></p>
<ul>
<li>
<p><code>e_vals_</code> : array-like, shape=[n_features]</p>
<p>Eigenvalues in sorted order.</p>
</li>
<li>
<p><code>e_vecs_</code> : array-like, shape=[n_features]</p>
<p>Eigenvectors in sorted order.</p>
</li>
<li>
<p><code>X_projected_</code> : array-like, shape=[n_samples, n_components]</p>
<p>Training samples projected along the component axes.</p>
</li>
</ul>
<h3 id="methods">Methods</h3>
<hr>

<p><em>fit(X)</em></p>
<p>Learn model from training data.</p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><code>X</code> : {array-like, sparse matrix}, shape = [n_samples, n_features]</p>
<p>Training vectors, where n_samples is the number of samples and
n_features is the number of features.</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>self</code> : object</li>
</ul>
<hr>

<p><em>transform(X)</em></p>
<p>Apply the non-linear transformation on X.</p>
<p><strong>Parameters</strong></p>
<ul>
<li>
<p><code>X</code> : {array-like, sparse matrix}, shape = [n_samples, n_features]</p>
<p>Training vectors, where n_samples is the number of samples and
n_features is the number of features.</p>
</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li>
<p><code>X_projected</code> : np.ndarray, shape = [n_samples, n_components]</p>
<p>Projected training vectors.</p>
</li>
</ul></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Copyright &copy; 2014-2017 <a href="http://sebastianraschka.com">Sebastian Raschka</a><br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../../js/jquery-1.10.2.min.js"></script>
    <script src="../../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../../..';
    </script>
    <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
    <script src="../../../js/base.js"></script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <script src="../../../mathjaxhelper.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
